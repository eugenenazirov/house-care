const popup=$(".popup"),projects=$(".projects__project"),seeMore=$(".see-more"),seeMoreText=$(".see-more__text"),seeMoreArrow=$(".see-more__arrow"),popupMenu=$("#popupMenu"),orderProjectBlocks=()=>{const e=$(".project__image");for(let o=1;o<e.length;o+=2){$(e[o]).css("order","1")}},hideThreeProjects=()=>{projects.slice(-3).hide(1e3),seeMoreText.text("Показать еще три проекта"),seeMoreArrow.css({transform:"rotate(180deg)"}),seeMore.off().click(showThreeProjects)},showThreeProjects=()=>{projects.slice(-3).show(1e3),seeMoreText.text("Скрыть последние три проекта"),seeMoreArrow.css({transform:"rotate(180deg)"}),seeMore.off().click(hideThreeProjects)},scrollToProjects=()=>{document.getElementById("projects").scrollIntoView({behavior:"smooth"})},scrollToConsultation=()=>{document.getElementById("consultationBlock").scrollIntoView({behavior:"smooth"})},showPopup=()=>{popup.removeClass("closed").hide().fadeIn()},hidePopup=()=>{popup.fadeOut(400,()=>{popup.addClass("closed")})},showMenu=()=>{$(window).width()<=768&&$("body").addClass("overflow-hidden"),popupMenu.show(300),[$("#menuClose"),$(".menu__item"),$(".place-to-hide-menu")].forEach(e=>{e.click(hideMenu)})},hideMenu=()=>{$("body").removeClass("overflow-hidden"),popupMenu.hide(300)},sendPostRequest=e=>{$.ajax({method:"POST",url:"https://testologia.site/checkout",data:e}).done(function(e){if(0===e.success)return alert("Произошла ошибка! Попробуйте снова"),!1;$(".consultation__form").hide(500,()=>{$(".thanks").removeClass("closed").hide().fadeIn(500)})})},clearForm=(e,o)=>{e.each(function(){let e=$(this);e.removeClass("invalid-input"),e.next().addClass("closed")}),o.removeClass("invalid-input")},validateForm=e=>{e.preventDefault();const o=e.target.parentElement.classList[0],s=$(`.${o} .form__input`),t=$(`.${o} .form__checkbox`);let r=[];if(clearForm(s,t),s.each(function(){if(!this.value.trim()){let e=$(this);e.addClass("invalid-input"),e.next().removeClass("closed"),r.push(`Input ${this.name} has invalid value.`)}}),t[0].checked||(t.addClass("invalid-input"),r.push(`Checkbox ${t[0].name} isn't checked!`)),0!==r.length)return r.forEach(e=>{console.log(e)}),!1;const c={name:s[0].value,phone:s[1].value};sendPostRequest(c)},showRelatedCard=e=>{let o=$(e.target);$(".mobile-circle-cursor").removeClass("active"),o.addClass("active"),$(".schema__info-block").hide().removeClass("active"),o.next().addClass("active").show()},moveProjectImages=e=>{$(window).width()<=e&&projects.each(function(){let e=$(this),o=e.children().first(),s=e.children().last();s.html(s.html()+o.prop("outerHTML")),o.remove()})},showMobileCards=()=>{$(".mobile-circle-cursor").click(showRelatedCard)};function main(){moveProjectImages(580),showMobileCards(),projects.slice(-3).hide(),orderProjectBlocks(),$("#tourBtn").click(showPopup),$("#scrollDown").click(scrollToProjects),$("#closeBtn").click(hidePopup),$("#burger").click(showMenu),seeMore.click(showThreeProjects),$(".to-consultation").each(function(){$(this).click(scrollToConsultation)}),$(".form__btn").click(validateForm),new Glide(".glide",{autoplay:3e3,hoverpause:!0}).mount(),$(".form__input.phone").each(function(){new IMask(this,{mask:"+{7} (000) 000-00-00"})}),$(".project__image").each(function(){$(this).magnificPopup({delegate:"a",gallery:{enabled:!0},type:"image"})})}$(document).ready(main);